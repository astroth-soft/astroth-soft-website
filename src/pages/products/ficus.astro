---
import BaseLayout_Ficus from "../../layouts/BaseLayout_Ficus.astro";
import Heading from "../../components/Heading.astro";
import RoundedButton from "../../components/RoundedButton.astro";
import NewsCard from "../../components/NewsCard.astro";
import { getCollection } from "astro:content";

interface allNews {
  title: string,
  date: string,
  href?: string,
}

const newses: allNews[] = [
  {
    title: "作品特設ページを開設しました！",
    date: "2025/09/13",
  },
];

const characters = [
  {
    name: "睦吏",
    nameEn: "mutsuri",
    image: "/assets/ficus/mutsuri.png",
    voice: "Coming Soon...",
    description:
      "主人公。女神の導きで「美」に目覚め、決起を呼びかけるが、当然の如く投獄されてしまう。そこで出逢った蛇羅や仁弖と共に監獄を脱し、「美」の「表現の自由」を求める反体制組織を設立。しかしそれは、血みどろの、正邪ゆらめく、謀略はびこる戦いの幕開けに過ぎなかった。",
  },
  {
    name: "波々 衣撫",
    nameEn: "ibu",
    image: "/assets/ficus/ibu.png",
    voice: "Coming Soon...",
    description:
      "何を考えているかわからない、不思議ちゃん系の女の子。路地裏で強姦されている所を、睦吏たちが助け、反体制組織に引き入れる。特異な体質であり、しかもそれは体制を倒す鍵だと言うが...... !?",
  },
  {
    name: "亞國 蛇羅",
    nameEn: "jala",
    image: "/assets/ficus/jala.png",
    voice: "Coming Soon...",
    description:
      "荒れた口調で、鞭を変幻自在に振るう男。睦吏と牢屋仲間になり、唆して共に脱獄する。体制に復讐する為の手段として、ロウソクや鞭打ちに固執するが、その真意とは――",
  },
  {
    name: "一之瀬 仁弖",
    nameEn: "nite",
    image: "/assets/ficus/nite.png",
    voice: "Coming Soon...",
    description:
      "武者口調で、刀や剣、銃を器用に操る男。本人は「侍」と呼ばれると怒る。睦吏と牢屋仲間になり、唆して共に脱獄する。戦闘で無類の強さを誇る一方で、体制側の管理番号 13 番に固執するが、その理由とは――",
  },
  {
    name: "シカ",
    nameEn: "deer",
    image: "/assets/ficus/deer.png",
    voice: "Coming Soon...",
    description:
      '人間と鹿のハーフ。睦吏を父と呼び慕う。睦吏と共に収監されるが、脱獄で大きな役割を果たす。「人間を知りたい」と言い、睦吏ら人間が " 美 " と " 表現 " に固執する理由を追い求める。',
  },
  {
    name: "管理番号 13 番",
    nameEn: "dasi",
    image: "/assets/ficus/dasi.png",
    voice: "Coming Soon...",
    description:
      "体制側の一番隊、斬り込み隊長。メイド服を着用している。如何なる状況でも厳しい表情を崩さず、大剣を振るって敵を成敗する。だが、仁弖を見てから、一つの葛藤が自分の内に湧き上がるのを感じていた――",
  },
  {
    name: "マビー・フェッツ",
    nameEn: "fetz",
    image: "/assets/ficus/fetz.png",
    voice: "Coming Soon...",
    description:
      "体制側の第 3 代総帥。本人は武官出身であるため、戦闘能力に優れており、総帥にもかかわらず突出しがちである。管理番号 13 番から崇敬される良き上司であったが、脱獄をきっかけにその関係性は変化する――",
  },
];

const characterButtonActiveClasses = "opacity-80";
const characterButtonInactiveClasses = "border-gray-500";

const productInfo = [
  {
    label: "タイトル",
    value: "イチジクの葉",
    subValue: "-The Leaf of Ficus Caricature-",
  },
  { label: "ジャンル", value: "美学 ADV" },
  { label: "ブランド", value: "Astroth" },
  { label: "レーティング", value: "18 歳以上" },
  {
    label: "発売予定日",
    value: "体験版 : 2025 年 11 月 02 日",
    subValue: "パッケージ版 : 2025 年 12 月 31 日",
    subsubValue: "DL 版 : 2026 年 01 月 01 日",
  },
  { label: "価　格", value: "1,000 円" },
];

const staffInfo = [
  { label: "原　作", value: ["涅槃明日太郎"] },
  { label: "脚　本", value: ["紅 坂 篤 樹"] },
  { label: "美　術", value: ["R O N", "七 星 ね ね", "かんぱーん"] },
  { label: "音　楽", value: ["彩 峰 冬 総", "keppekigirl"] },
  {
    label: "プログラム",
    value: [
      "彩 峰 黎 斗",
      "こ ん そ め",
      "n a g i",
      "nukanoto",
      "キュビット",
      "に ゐ つ",
    ],
  },
  { label: "スクリプト", value: ["彩 峰 黎 斗"] },
  { label: "プロデューサー", value: ["彩 峰 慶 次"] },
  { label: "監　督", value: ["彩 峰 鋼 一"] },
  { label: "製作総指揮", value: ["A K 4 7"] },
];

const titleItem = productInfo.find((item) => item.label === "タイトル");
---

<BaseLayout_Ficus pageTitle="イチジクの葉 | Astroth">
  <div class="flex justify-center">
    <img src="/assets/ficus_logo.png" class="w-full px-10" />
  </div>

  <div class="h-16 w-0 border-1 border-dark-1 border-style-solid mx-auto my-4 wipe-in" id="news" />

  <h2
      class="font-lobster text-black text-stroke-1 text-stroke-pink-6 text-center text-4xl py-4 flex justify-center scroll-mt-28"
      id="story"
    >
      <span>NEW</span>
      <span class="blinking-text-4">S</span>
    </h2>
  <div class="mx-auto my-4 w-128 h-96 border-1 border-white border-style-solid">
    {
      newses.map((news) => (
        news.href ? <a href={news.href}> : ""

        news.href ? </a> : ""
      ))
    }
  </div>

  <div class="h-16 w-0 border-1 border-dark-1 border-style-solid mx-auto my-4 wipe-in" />

  <div
    class="mx-auto w-full lg:w-60% h-auto font-shippori wipe-in"
  >
    <h2
      class="font-lobster text-black text-stroke-1 text-stroke-pink-6 text-center text-4xl py-4 flex justify-center scroll-mt-28"
      id="story"
    >
      <span class="blinking-text-4">S</span>
      <span>TORY</span>
    </h2>
    <p class="text-center text-2xl font-bold mx-2">
      ――俺は作りたいんだ !<br />誰もが、自己を表現できる世界をっ…… !
    </p>
    <p class="text-center mx-2">
      あらゆる " 表現 " が消し去られた、西暦 2030 年の冬。<br />
      生きる目的を失った人間たちだったが、その中に " 表現 " 復活への希望の火が灯った。<br
      />
      主人公・睦吏は、女神に導かれ、睦吏を父と慕う人間とシカのハーフ・幹利や、<br
      />
      " 表現 " のある世界を望む同志・蛇羅、仁弖と出逢う。<br />
      彼らの " 美学 " は少しずつ違うが、目指す理想は同じ――
    </p>
    <p class="text-center text-2xl mx-2">
      すべての " 美 " が、 " 表現 " される世界だッ !
    </p>
    <p class="text-center pb-4 mx-2">
      これは――すべての人間に捧ぐ、 " 美学 " ノベルゲームである。
    </p>
  </div>

  <div class="h-16 w-0 border-1 border-dark-1 border-style-solid mx-auto my-4 wipe-in" />

  <div
    class="mx-auto w-full lg:w-60% font-shippori wipe-in"
  >
    <h2
      class="font-lobster text-black text-stroke-1 text-stroke-cyan text-center text-4xl py-4 flex justify-center scroll-mt-28"
      id="characters"
    >
      <span class="blinking-text-1">C</span>
      <span>HARA</span>
      <span class="blinking-text-2">C</span>
      <span>TER</span>
      <span class="blinking-text-3">S</span>
    </h2>

    <!-- キャラクター選択 -->
    <div class="p-4 space-y-4">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
        {
          characters.map((character, index) => (
            <button
              class="character-btn p-1 mx-5 text-center opacity-70 hover:opacity-100 hover:font-bold transition-all bg-transparent border-b-2 border-b-white cursor-pointer text-white border-transparent border-solid font-ibm"
              data-character={index}
            >
              {character.name}
            </button>
          ))
        }
      </div>

      <!-- キャラクター表示 -->
      <div class="border-t border-gray-500 pt-4">
        <div class="grid md:grid-cols-3 gap-4">
          <img
            id="character-image"
            src={characters[0].image}
            alt={characters[0].name}
            class="w-full max-w-xs mx-auto"
          />
          <div class="md:col-span-2 space-y-2">
            <h3 id="character-name" class="text-2xl font-bold">
              {characters[0].name}
            </h3>
            <p id="character-voice" class="text-lg text-gray-300">
              演: {characters[0].voice}
            </p>
            <p id="character-description" class="leading-relaxed">
              {characters[0].description}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script define:vars={{ characters }}>
    const buttons = document.querySelectorAll(".character-btn");
    const characterImage = document.getElementById("character-image");
    const characterName = document.getElementById("character-name");
    const characterVoice = document.getElementById("character-voice");
    const characterDescription = document.getElementById(
      "character-description",
    );

    // 最初のボタンをアクティブに
    if (buttons[0]) {
      buttons[0].classList.remove("opacity-70");
      buttons[0].classList.add("opacity-100", "font-bold");
    }

    buttons.forEach((button, index) => {
      button.addEventListener("click", () => {
        // すべてのボタンを非アクティブに
        buttons.forEach((btn) => {
          btn.classList.remove("opacity-100", "font-bold");
          btn.classList.add("opacity-70");
        });

        // クリックされたボタンをアクティブに
        button.classList.remove("opacity-70");
        button.classList.add("opacity-100", "font-bold");

        // キャラクター情報を更新
        const character = characters[index];
        if (characterImage && character) {
          characterImage.src = character.image;
          characterImage.alt = character.name;
        }
        if (characterName && character) {
          characterName.textContent = character.name;
        }
        if (characterVoice && character) {
          characterVoice.textContent = `演: ${character.voice}`;
        }
        if (characterDescription && character) {
          characterDescription.textContent = character.description;
        }
      });
    });
  </script>

  <div class="h-16 w-0 border-1 border-dark-1 border-style-solid mx-auto my-4 wipe-in" />

  <div
    class="mx-auto mt-8 w-full lg:w-60% h-auto font-shippori wipe-in"
  >
    <h2
      class="font-lobster text-black text-stroke-1 text-stroke-pink-6 text-center text-4xl py-4 flex justify-center scroll-mt-28"
      id="product"
    >
      <span>PROD</span>
      <span class="blinking-text-4">U</span>
      <span class="blinking-text-5">C</span>
      <span>T</span>
    </h2>
    <div class="p-4 grid md:grid-cols-3 sm:grid-cols-2 place-items-top">
      {
        productInfo.map((item) => (
          <div class="mb-6 md:mx-0 sm:mx-auto">
            <p class="font-ibm font-bold m-0 text-center mx-2 mb-1">
              {item.label}
            </p>
            <p
              class={`font-shippori font-bold text-center m-0 ${
                item.label === "タイトル"
                  ? "text-3xl"
                  : item.label === "発売予定日"
                    ? ""
                    : "text-2xl"
              }`}
            >
              {item.value}
            </p>
            {item.subValue && (
              <p class="font-shippori font-bold text-center m-0">
                {item.subValue}
              </p>
            )}
            {item.subsubValue && (
              <p class="font-shippori font-bold text-center m-0">
                {item.subsubValue}
              </p>
            )}
          </div>
        ))
      }
    </div>
  </div>

  <div class="h-16 w-0 border-1 border-dark-1 border-style-solid mx-auto my-4 wipe-in" />

  <div
    class="mx-auto w-full lg:w-60% font-shippori wipe-in"
  >
    <h2
      class="font-lobster text-black text-stroke-1 text-stroke-cyan text-center text-4xl py-4 flex justify-center scroll-mt-28"
      id="staff"
    >
      <span class="m-0">STA</span>
      <span class="m-0 blinking-text-1">F</span>
      <span class="m-0 blinking-text-2">F</span>
    </h2>
    <div class="p-4 grid md:grid-cols-3 sm:grid-cols-2 gap-4 place-items-top">
      {
        staffInfo.map((item) => (
          <div class="mb-6 md:mx-0 sm:mx-auto">
            <p class="font-ibm font-bold m-0 text-center mx-2 mb-1">
              {item.label}
            </p>
            {item.label === "プログラム" && item.value.length > 3 ? (
              <div class="grid grid-cols-2 grid-rows-3 gap-2">
                {item.value.map((person) => (
                  <p class="font-ibm text-center m-0">{person}</p>
                ))}
              </div>
            ) : (
              item.value.map((person) => (
                <p class="font-ibm text-2xl text-center m-0">{person}</p>
              ))
            )}
          </div>
        ))
      }
    </div>
  </div>

  <!--
        <p class="text-3xl">ダウンロード購入ページ</p>
        <hr class="w-100 ml-0 mr-auto" />

        <div class="grid grid-rows-3 grid-cols-1 place-contents-center place-items-center w-fill">
          <div class="flex w-200 gap-20 pt-10 pb-10 m-4 bg-dark-9 p-5">
            <button type="button" class="w-50 h-20 bg-blue-500 ml-10 hover:bg-blue-700 text-white font-roundedibm font-bold text-3xl border-0 rounded">Booth</button>
            <div class="flex-col">
              <p class="text-2xl pb-5">Boothでの購入ページはこちら</p>
              <li class="text-xl">注意事項等</li>
            </div>
          </div>

          <div class="flex w-200 gap-20 pt-10 pb-10 bg-dark-9 p-5">
            <button type="button" class="w-50 h-20 bg-blue-500 ml-10 hover:bg-blue-700 text-white font-roundedibm font-bold text-3xl border-0 rounded">Fanza</button>
            <div class="flex-col">
            <p class="text-2xl pb-5">Fanzaでの購入ページはこちら</p>
            <li class="text-xl">注意事項等</li>
            </div>
          </div>

          <div class="flex w-200 gap-20 pt-10 pb-10 bg-dark-9 p-5">
            <button type="button" class="w-50 h-20 bg-blue-500 ml-10 hover:bg-blue-700 text-white font-roundedibm font-bold text-3xl border-0 rounded">DLsite</button>
            <div class="flex-col">
            <p class="text-2xl pb-5">DLsiteでの購入ページはこちら</p>
            <li class="text-xl">注意事項等</li>
            </div>
          </div>
        </div>
      </div>
    </div> -->
</BaseLayout_Ficus>

<script>
  import { animate, stagger, inView } from "motion";

  let opacities = [
    [0.6, 0.6, 1, 1, 0.6, 0.6, 1],
    [1, 0.6, 0.6, 0.6, 0.6, 1, 1, 0.6],
    [1, 1, 0.6, 1, 0.6, 0.6, 1],
    [0, 6, 1, 1, 0.6, 0.6, 1, 1],
  ];

  for (let i = 0; i < 4; i++) {
    inView(`.blinking-text-${i + 1}`, (element) => {
      animate(
        element,
        { opacity: opacities[i] },
        {
          duration: 0.5,
          repeat: Infinity,
          delay: stagger(0.5, { from: "center" }),
        },
      );
    });
  }

  inView(".wipe-in", (info) => {
    animate(
      info,
      { opacity: [0, 1], y: [20, 0] },
      { duration: 0.8, easing: "ease-out" },
    );
  });
</script>
